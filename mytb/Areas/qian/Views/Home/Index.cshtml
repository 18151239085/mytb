@{
	ViewData["Title"] = "Index";
	Layout = null;
}
@model Models.zh
<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>贴吧</title>
    <link rel="stylesheet" href="~/lib/layui/css/layui.css" />
    <link rel="stylesheet" href="/content/css/font-awesome/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/content/css/swiper/dist/css/swiper.css" />
    <link rel="stylesheet" id="layuicss-layer" href="~/lib/layui/css/modules/layer/default/layer.css" media="all">
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        .main-box {
            margin: 0 auto;
            width: 1000px;
            border: 1px solid red;
            height: 1700px;
        }

        #lbt {
            margin-bottom: 12px;
            height: 500px;
            border: 1px solid #ccc;
        }

            #lbt .left {
                display: inline-block;
                height: 353px;
                /*width:670px;*/
                float: left;
                overflow: hidden;
                /*border:1px solid red;*/
            }

        #main {
            width: 1000px;
            margin: 0 auto;
            border: 1px solid #ccc;
            height: 1000px;
            margin-top: 35px;
        }

            #main .left {
                float: left;
                width: 205px;
                border: 1px solid #ccc;
                height: 905px;
                display: inline-block;
                padding: 32px;
                margin: 10px;
            }

            #main .right {
                float: left;
                margin-left: 10px;
                width: 621px;
                height: 905px;
                border: 1px solid #ccc;
                display: inline-block;
                padding: 20px;
                margin: 10px;
            }

        #foot {
            height: 100px;
            border: 1px solid #ccc;
            width: 946px;
            padding: 20px;
        }

        .ft {
            /*position: fixed;*/
            width: 105px;
            height: 50px;
            /*border: 1px solid #e8e8e8;*/
            /*top: 100px;
            left: 200px;*/
			padding:14px 23px;
        }

            .ft button {
                width: 100px;
                height: 50px;
                background-color: #fff;
                font-size: 25px;
            }

        .right li {
            height: 30px;
            line-height: 30px;
        }

            .right li a {
                display: block;
            }

                .right li a:hover {
                    background: #e8e8e8;
                    color: black;
                }
    </style>
</head>

<body>
	@await Component.InvokeAsync("tbHeader")
	<div class="main-box">

		<div class="container" id="lbt">
			<div class="left">
				<div class="ft"><button onclick="btn_ft()" id="ft">发帖</button></div>
			</div>
			@*<div class="right">
					<img src="/content/image/bdtb.png" />
				</div>*@
		</div>
		<div class="container" id="main">
			<div class="left">

			</div>
			<div class="right">
				<div class="container" id="fwdt">
					<h3 class="big-title">贴子列表</h3>
					<div class="gridPanel" id="horizontal">
						<table id="gridList"></table>
					</div>
				</div>

			</div>
		<div class="container" id="foot">
			滴不滴不滴不滴不滴不
		</div>
	</div>
	<style>
		#gridList {
			table-layout: fixed; /* 只有定义了表格的布局算法为fixed，下面td的定义才能起作用。 */
		}

			#gridList td {
				border-width: 1px;
				width: 100%;
				word-break: keep-all;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}

		#link {
			color: #2c8ea0;
			cursor: pointer;
		}
	</style>
	<script src="~/lib/jquery/dist/jquery.js"></script>
	<script src="~/lib/kendoui/js/kendo.all.min.js"></script>
	<script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
	<script src="~/lib/layui/layui.js"></script>
	<script src="~/js/layer.js"></script>
	<script src="~/js/SmartFrame.js"></script>
	<script src="~/js/SmartFLowOperates.js"></script>
	<script>
		$(document).ready(function () {
			$("#gridList").SmartGrid({
				dataSource: {
					batch: true,
					schema: {
						data: "Data",
						total: "Total"
					},
					transport: {
						type: "odata",
						read: {
							url: "/qian/home/gettzlist" ,
							contentType: "application/json",
							type: "POST"
						}, parameterMap: function (data, operation) {
							return JSON.stringify(data)
						},
					},
					//filter: { field: "F_LAYERS", operator: "eq", value: 1 }
				},
				height: 500,
				groupable: false,
				sortable: true,
				pageable: {
					refresh: true,
					pageSizes: true,
					buttonCount: 5
				},
				columns: [{
					field: "rowNumber",
					title: "序号",
					template: "<span class='row-number'></span>", width: 50
				},
				{
					field: "MH_TITLE",
					title: "标题",
					width: 200
				},
				{
					field: "create_time",
					title: "时间",
					width: 100
				}

				],
				dataBound: function () {
					var rows = this.items();
					$(rows).each(function () {
						var index = $(this).index() + 1;
						var rowLabel = $(this).find(".row-number");
						$(rowLabel).html(index);
					});
				},
			});
		});
		function btn_ft() {
			$.ajax({
				url: "/qian/user/isLogin",
				type: "post",
				dataType: "json",
				success: function (data) {
					if (data) {
						$.modalOpen({
							id: "Form",
							title: "发帖页面",
							url: "/qian/ftz/ft?keyValue=0",
							width: "1200px",
							height: "600px",
							fullScreen: true,
							callBack: function (iframeId) {
								//点击确认按钮
								// 执行的函数
								top.frames[iframeId].submitForm(reloading);
							}
						});
					} else {
						window.location = "/qian/user/login";
					}
				}
			});

		}
		function reloading() {
			// 刷新当前页
			window.location.reload();
		}
	</script>
</body>
</html>